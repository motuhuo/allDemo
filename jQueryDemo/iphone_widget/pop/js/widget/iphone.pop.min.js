(function(c){c.fn.extend({popOn:function(b){function e(b){a.off("close",e);"button"==g&&0<k.length?k.off(h,e):"full"==g&&a.off(h,e);0<d?(f&&l.transition({opacity:0},Math.round(d/2)),a.transition({opacity:0},Math.round(d/2),q)):q()}function q(){a.hide();f&&(a.unwrap(),c(document).off("touchmove",r));m&&m(a)}function r(a){a.preventDefault()}var a=c(this),n,l,d=250,f=!0,p,m,k=a.find("a.close"),h="touchend",g="button";b&&(n=b.top,d=null!=b.fade?b.fade:250,f=null!=b.wrap?b.wrap:!0,g=null!=b.closeType?b.closeType:"button",h=null!=b.closeEvent?b.closeEvent:"touchend",p=b.onOpen,m=b.onClose);f&&(a.parent().hasClass("popBox")||a.wrap("<div class='popBox'></div>"),l=a.parent());a.show();p&&p(a);0<d&&(f&&l.css({opacity:0}).transition({opacity:1},d),a.css({opacity:0}).transition({opacity:1},d));f&&(a.css({left:c(window).width()/2-a.outerWidth()/2}),n?a.css({top:n}):a.css({top:c(window).height()/2-a.outerHeight()/2}),c(document).on("touchmove",r));a.on("off",e);if("button"==g&&0<k.length)k.one(h,e);else if("full"==g)a.one(h,e)},popOff:function(){c(this).trigger("off")}})})(jQuery);