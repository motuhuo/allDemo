(function(f){f.mobiscroll.classes.Scroller=function(I,aJ){var Y,am,P,A,au,aC,y,z,ar,aB,av,ad,ab,S,F,aD,aa,az,C,H,aA,V,aS,D,aL,ao,aM,ae,aO,ai,aw,aF,L,aQ,ag,X=this,ac=I,ax=f(ac),T=w({},k),O={},M={},aI={},ah={},K=[],aq=[],aU=ax.is("input"),E=false,an=function(aV){if(b(aV)&&!n&&!F&&!ag&&!Q(this)){aV.preventDefault();n=true;aa=T.mode!="clickpick";ao=f(".dw-ul",this);aN(ao);az=M[aM]!==undefined;V=az?aE(ao):aI[aM];C=c(aV,"Y");H=new Date();aA=C;at(ao,aM,V,0.001);if(aa){ao.closest(".dwwl").addClass("dwa")}f(document).on(x,Z).on(m,U)}},Z=function(aV){if(aa){aV.preventDefault();aV.stopPropagation();aA=c(aV,"Y");at(ao,aM,p(V+(C-aA)/am,aS-1,D+1))}if(C!==aA){az=true}},U=function(a1){var aY=new Date()-H,aX=p(V+(C-aA)/am,aS-1,D+1),aZ,a2,aW,a0=ao.offset().top;if(aY<300){aZ=(aA-C)/aY;a2=(aZ*aZ)/T.speedUnit;if(aA-C<0){a2=-a2}}else{a2=aA-C}aW=Math.round(V-a2/am);if(!a2&&!az){var a3=Math.floor((aA-a0)/am),a4=f(f(".dw-li",ao)[a3]),aV=aa;if(W("onValueTap",[a4])!==false){aW=a3}else{aV=true}if(aV){a4.addClass("dw-hl");setTimeout(function(){a4.removeClass("dw-hl")},200)}}if(aa){af(ao,aW,0,true,Math.round(aX))}n=false;ao=null;f(document).off(x,Z).off(m,U)},ay=function(aV){if(ag){ag.removeClass("dwb-a")}ag=f(this);f(document).on(m,aT);if(!ag.hasClass("dwb-d")&&!ag.hasClass("dwb-nhl")){ag.addClass("dwb-a")}if(ag.hasClass("dwwb")){if(b(aV)){R(aV,ag.closest(".dwwl"),ag.hasClass("dwwbp")?aR:B)}}},aT=function(aV){if(F){clearInterval(ae);F=false}if(ag){ag.removeClass("dwb-a");ag=null}f(document).off(m,aT)},J=function(aV){if(aV.keyCode==38){R(aV,f(this),B)}else{if(aV.keyCode==40){R(aV,f(this),aR)}}},ap=function(aV){if(F){clearInterval(ae);F=false}},aK=function(aW){if(!Q(this)){aW.preventDefault();aW=aW.originalEvent||aW;var aX=aW.wheelDelta?(aW.wheelDelta/120):(aW.detail?(-aW.detail/3):0),aV=f(".dw-ul",this);aN(aV);af(aV,Math.round(aI[aM]-aX),aX<0?1:2)}};function R(aY,aV,aX){aY.stopPropagation();aY.preventDefault();if(!F&&!Q(aV)&&!aV.hasClass("dwa")){F=true;var aW=aV.find(".dw-ul");aN(aW);clearInterval(ae);ae=setInterval(function(){aX(aW)},T.delay);aX(aW)}}function Q(aV){if(f.isArray(T.readonly)){var aW=f(".dwwl",A).index(aV);return T.readonly[aW]}return T.readonly}function N(aZ){var aY='<div class="dw-bf">',a1=K[aZ],aW=a1.values?a1:h(a1),aV=1,a2=aW.labels||[],aX=aW.values,a0=aW.keys||aX;f.each(aX,function(a4,a3){if(aV%20==0){aY+='</div><div class="dw-bf">'}aY+='<div role="option" aria-selected="false" class="dw-li dw-v" data-val="'+a0[a4]+'"'+(a2[a4]?' aria-label="'+a2[a4]+'"':"")+' style="height:'+am+"px;line-height:"+am+'px;"><div class="dw-i">'+a3+"</div></div>";aV++});aY+="</div>";return aY}function aN(aV){aS=f(".dw-li",aV).index(f(".dw-v",aV).eq(0));D=f(".dw-li",aV).index(f(".dw-v",aV).eq(-1));aM=f(".dw-ul",A).index(aV)}function aH(aV){var aW=T.headerText;return aW?(typeof aW==="function"?aW.call(ac,aV):aW.replace(/\{value\}/i,aV)):""}function aj(){X.temp=X.values?X.values.slice(0):T.parseValue(ax.val()||"",X);aP()}function aE(aX){var aY=window.getComputedStyle?getComputedStyle(aX[0]):aX[0].style,aV,aW;if(l){f.each(["t","webkitT","MozT","OT","msT"],function(a0,aZ){if(aY[aZ+"ransform"]!==undefined){aV=aY[aZ+"ransform"];return false}});aV=aV.split(")")[0].split(", ");aW=aV[13]||aV[5]}else{aW=aY.top.replace("px","")}return Math.round(Y-(aW/am))}function G(aW,aV){clearTimeout(M[aV]);delete M[aV];aW.closest(".dwwl").removeClass("dwa")}function at(aY,aV,a2,a1,a0){var aX=(Y-a2)*am,aZ=aY[0].style,aW;if(aX==ah[aV]&&M[aV]){return}if(a1&&aX!=ah[aV]){W("onAnimStart",[A,aV,a1])}ah[aV]=aX;aZ[q+"Transition"]="all "+(a1?a1.toFixed(3):0)+"s ease-out";if(l){aZ[q+"Transform"]="translate3d(0,"+aX+"px,0)"}else{aZ.top=aX+"px"}if(M[aV]){G(aY,aV)}if(a1&&a0){aY.closest(".dwwl").addClass("dwa");M[aV]=setTimeout(function(){G(aY,aV)},a1*1000)}aI[aV]=a2}function ak(aV,a4,aW){var a3=f('.dw-li[data-val="'+aV+'"]',a4),a5=f(".dw-li",a4),a2=a5.index(a3),aX=a5.length;if(!a3.hasClass("dw-v")){var a1=a3,a0=a3,aZ=0,aY=0;while(a2-aZ>=0&&!a1.hasClass("dw-v")){aZ++;a1=a5.eq(a2-aZ)}while(a2+aY<aX&&!a0.hasClass("dw-v")){aY++;a0=a5.eq(a2+aY)}if(((aY<aZ&&aY&&aW!==2)||!aZ||(a2-aZ<0)||aW==1)&&a0.hasClass("dw-v")){a3=a0;a2=a2+aY}else{a3=a1;a2=a2-aZ}}return{cell:a3,v:a2,val:a3.attr("data-val")}}function al(aZ,aW,aX,aV,aY){if(W("validate",[A,aW,aZ,aV])!==false){f(".dw-ul",A).each(function(a3){var a2=f(this),a4=a3==aW||aW===undefined,a1=ak(X.temp[a3],a2,aV),a0=a1.cell;if(!(a0.hasClass("dw-sel"))||a4){X.temp[a3]=a1.val;if(!T.multiple){f(".dw-sel",a2).removeAttr("aria-selected");a0.attr("aria-selected","true")}f(".dw-sel",a2).removeClass("dw-sel");a0.addClass("dw-sel");at(a2,a3,a1.v,a4?aZ:0.1,a4?aY:false)}});P=T.formatResult(X.temp);if(X.live){aP(aX,0,true)}f(".dwv",A).html(aH(P));if(aX){W("onChange",[P])}}}function W(aX,aW){var aV;aW.push(X);f.each([ab,O,aJ],function(aZ,aY){if(aY&&aY[aX]){aV=aY[aX].apply(ac,aW)}});return aV}function af(a4,aW,aY,a0,a2){aW=p(aW,aS,D);var a3=f(".dw-li",a4).eq(aW),aV=a2===undefined?aW:a2,aZ=a2!==undefined,a1=aM,aX=a0?(aW==aV?0.1:Math.abs((aW-aV)*T.timeUnit)):0;X.temp[a1]=a3.attr("data-val");at(a4,a1,aW,aX,aZ);setTimeout(function(){al(aX,a1,true,aY,aZ)},10)}function aR(aV){var aW=aI[aM]+1;af(aV,aW>D?aS:aW,1,true)}function B(aV){var aW=aI[aM]-1;af(aV,aW<aS?D:aW,2,true)}function aP(aZ,aY,aX,aV,aW){if(E&&!aX){al(aY,undefined,aW)}P=T.formatResult(X.temp);if(!aV){X.values=X.temp.slice(0);X.val=P}if(aZ&&aU){ai=true;ax.val(P).change()}}function aG(aW,aX){var aV;aF.on(aW,function(aY){clearTimeout(aV);aV=setTimeout(function(){if((av&&aX)||!aX){X.position(!aX)}},200)})}X.position=function(bf){if(!aL||aw||(y===au.width()&&z===(aF[0].innerHeight||aF.innerHeight())&&bf)||(W("onPosition",[A])===false)){return}var a2,a8,a4,a3,bb,a6,a5,a9,aW,ba,aV,bc,aX,bg=0,aZ=0,bd=aF.scrollLeft(),a7=aF.scrollTop(),aY=f(".dwwr",A),be=f(".dw",A),a1={},a0=T.anchor===undefined?ax:T.anchor;y=au.width();z=aF[0].innerHeight||aF.innerHeight();if(/modal|bubble/.test(T.display)){f(".dwc",A).each(function(){a2=f(this).outerWidth(true);bg+=a2;aZ=(a2>aZ)?a2:aZ});a2=bg>y?aZ:bg;aY.width(a2).css("white-space",bg>y?"":"nowrap")}ar=be.outerWidth();aB=be.outerHeight(true);av=aB<=z&&ar<=y;X.scrollLock=av;if(T.display=="modal"){a8=(y-ar)/2;a4=a7+(z-aB)/2}else{if(T.display=="bubble"){aX=true;aW=f(".dw-arrw-i",A);a6=a0.offset();a5=Math.abs(f(T.context).offset().top-a6.top);a9=Math.abs(f(T.context).offset().left-a6.left);a3=a0.outerWidth();bb=a0.outerHeight();a8=p(a9-(be.outerWidth(true)-a3)/2-bd,3,y-ar-3);a4=a5-aB;if((a4<a7)||(a5>a7+z)){be.removeClass("dw-bubble-top").addClass("dw-bubble-bottom");a4=a5+bb}else{be.removeClass("dw-bubble-bottom").addClass("dw-bubble-top")}ba=aW.outerWidth();aV=p(a9+a3/2-(a8+(ar-ba)/2)-bd,0,ba);f(".dw-arr",A).css({left:aV})}else{a1.width="100%";if(T.display=="top"){a4=a7}else{if(T.display=="bottom"){a4=a7+z-aB}}}}a1.top=a4<0?0:a4;a1.left=a8;be.css(a1);au.height(0);bc=Math.max(a4+aB,T.context=="body"?f(document).height():L.scrollHeight);au.css({height:bc,left:bd});if(aX&&((a4+aB>a7+z)||(a5>a7+z))){aw=true;setTimeout(function(){aw=false},300);aF.scrollTop(Math.min(a4+aB-z,bc-z))}};X.enable=function(){T.disabled=false;if(aU){ax.prop("disabled",false)}};X.disable=function(){T.disabled=true;if(aU){ax.prop("disabled",true)}};X.setValue=function(aW,aY,aX,aV){X.temp=f.isArray(aW)?aW.slice(0):T.parseValue.call(ac,aW+"",X);aP(aY,aX,false,aV,aY)};X.getValue=function(){return X.values};X.getValues=function(){var aV=[],aW;for(aW in X._selectedValues){aV.push(X._selectedValues[aW])}return aV};X.changeWheel=function(aV,aZ,aX){if(A){var aW=0,aY=aV.length;f.each(T.wheels,function(a1,a0){f.each(a0,function(a3,a2){if(f.inArray(aW,aV)>-1){K[aW]=a2;f(".dw-ul",A).eq(aW).html(N(aW));aY--;if(!aY){X.position();al(aZ,undefined,aX);return false}}aW++});if(!aY){return false}})}};X.isVisible=function(){return E};X.tap=function(aY,aX){var aW,aV;if(T.tap){aY.on("touchstart.dw mousedown.dw",function(aZ){aZ.preventDefault();aW=c(aZ,"X");aV=c(aZ,"Y")}).on("touchend.dw",function(aZ){if(Math.abs(c(aZ,"X")-aW)<20&&Math.abs(c(aZ,"Y")-aV)<20){aX.call(this,aZ)}u()})}aY.on("click.dw",function(aZ){if(!t){aX.call(this,aZ)}aZ.preventDefault()})};X.show=function(aY){if(T.disabled||E){return}if(T.display=="top"){ad="slidedown"}if(T.display=="bottom"){ad="slideup"}aj();W("onBeforeShow",[]);var a1,aX=0,a2="";if(ad&&!aY){a2="dw-"+ad+" dw-in"}var a0='<div role="dialog" class="'+T.theme+" dw-"+T.display+(s?" dw"+s.replace(/\-$/,""):"")+(aD?"":" dw-nobtn")+'">'+(!aL?'<div class="dw dwbg dwi">':'<div class="dw-persp"><div class="dwo"></div><div class="dw dwbg '+a2+'"><div class="dw-arrw"><div class="dw-arrw-i"><div class="dw-arr"></div></div></div>')+'<div class="dwwr"><div aria-live="assertive" class="dwv'+(T.headerText?"":" dw-hidden")+'"></div><div class="dwcc">',aZ=f.isArray(T.minWidth),aW=f.isArray(T.maxWidth),aV=f.isArray(T.fixedWidth);f.each(T.wheels,function(a4,a3){a0+='<div class="dwc'+(T.mode!="scroller"?" dwpm":" dwsc")+(T.showLabel?"":" dwhl")+'"><div class="dwwc dwrc"><table cellpadding="0" cellspacing="0"><tr>';f.each(a3,function(a6,a5){K[aX]=a5;a1=a5.label!==undefined?a5.label:a6;a0+='<td><div class="dwwl dwrc dwwl'+aX+'">'+(T.mode!="scroller"?'<a href="#" tabindex="-1" class="dwb-e dwwb dwwbp" style="height:'+am+"px;line-height:"+am+'px;"><span>+</span></a><a href="#" tabindex="-1" class="dwb-e dwwb dwwbm" style="height:'+am+"px;line-height:"+am+'px;"><span>&ndash;</span></a>':"")+'<div class="dwl">'+a1+'</div><div tabindex="0" aria-live="off" aria-label="'+a1+'" role="listbox" class="dwww"><div class="dww" style="height:'+(T.rows*am)+"px;"+(T.fixedWidth?("width:"+(aV?T.fixedWidth[aX]:T.fixedWidth)+"px;"):(T.minWidth?("min-width:"+(aZ?T.minWidth[aX]:T.minWidth)+"px;"):"min-width:"+T.width+"px;")+(T.maxWidth?("max-width:"+(aW?T.maxWidth[aX]:T.maxWidth)+"px;"):""))+'"><div class="dw-ul">';a0+=N(aX);a0+='</div><div class="dwwol"></div></div><div class="dwwo"></div></div><div class="dwwol"></div></div></td>';aX++});a0+="</tr></table></div></div>"});a0+="</div>";if(aL&&aD){a0+='<div class="dwbc">';f.each(aQ,function(a4,a3){a3=(typeof a3==="string")?X.buttons[a3]:a3;a0+="<span"+(T.btnWidth?' style="width:'+(100/aQ.length)+'%"':"")+' class="dwbw '+a3.css+'"><a href="#" class="dwb dwb'+a4+' dwb-e" role="button">'+a3.text+"</a></span>"});a0+="</div>"}a0+=(aL?"</div>":"")+"</div></div></div>";A=f(a0);au=f(".dw-persp",A);aC=f(".dwo",A);al();W("onMarkupReady",[A]);if(aL){A.appendTo(T.context);if(ad&&!aY){A.addClass("dw-trans");setTimeout(function(){A.removeClass("dw-trans").find(".dw").removeClass(a2)},350)}}else{if(ax.is("div")){ax.html(A)}else{A.insertAfter(ax)}}W("onMarkupInserted",[A]);E=true;if(aL){f(window).on("keydown.dw",function(a3){if(a3.keyCode==13){X.select()}else{if(a3.keyCode==27){X.cancel()}}});if(T.scrollLock){A.on("touchmove",function(a3){if(av){a3.preventDefault()}})}f("input,select,button",L).each(function(){if(!this.disabled){if(f(this).attr("autocomplete")){f(this).data("autocomplete",f(this).attr("autocomplete"))}f(this).addClass("dwtd").prop("disabled",true).attr("autocomplete","off")}});X.position();aG("orientationchange.dw resize.dw",false);aG("scroll.dw",true)}A.on("DOMMouseScroll mousewheel",".dwwl",aK).on("keydown",".dwwl",J).on("keyup",".dwwl",ap).on("selectstart mousedown",e).on("click",".dwb-e",e).on("touchend",function(){if(T.tap){u()}}).on("keydown",".dwb-e",function(a3){if(a3.keyCode==32){a3.preventDefault();a3.stopPropagation();f(this).click()}});setTimeout(function(){f.each(aQ,function(a4,a3){X.tap(f(".dwb"+a4,A),function(a5){a3=(typeof a3==="string")?X.buttons[a3]:a3;a3.handler.call(this,a5,X)})});if(T.closeOnOverlay){X.tap(aC,function(){X.cancel()})}A.on(r,".dwwl",an).on(r,".dwb-e",ay)},300);W("onShow",[A,P])};X.hide=function(aW,aX,aY){if(!E||(!aY&&W("onClose",[P,aX])===false)){return}f(".dwtd",L).each(function(){f(this).prop("disabled",false).removeClass("dwtd");if(f(this).data("autocomplete")){f(this).attr("autocomplete",f(this).data("autocomplete"))}else{f(this).removeAttr("autocomplete")}});if(A){var aV=aL&&ad&&!aW;if(aV){A.addClass("dw-trans").find(".dw").addClass("dw-"+ad+" dw-out")}if(aW){A.remove()}else{setTimeout(function(){A.remove();if(i){v=true;i.focus()}},aV?350:1)}aF.off(".dw")}ah={};E=false};X.select=function(){if(X.hide(false,"set")!==false){aP(true,0,true);W("onSelect",[X.val])}};X.attachShow=function(aW,aV){aq.push(aW);if(T.display!=="inline"){aW.on((T.showOnFocus?"focus.dw":"")+(T.showOnTap?" click.dw":""),function(aX){if((aX.type!=="focus"||(aX.type==="focus"&&!v))&&!t){if(aV){aV()}i=aW;X.show()}setTimeout(function(){v=false},300)})}};X.cancel=function(){if(X.hide(false,"cancel")!==false){W("onCancel",[X.val])}};X.init=function(aV){ab=o.themes[aV.theme||T.theme];S=o.i18n[aV.lang||T.lang];w(aJ,aV);W("onThemeLoad",[S,aJ]);w(T,ab,S,aJ);T.buttons=T.buttons||["set","cancel"];T.headerText=T.headerText===undefined?(T.display!=="inline"?"{value}":false):T.headerText;X.settings=T;ax.off(".dw");var aW=o.presets[T.preset];if(aW){O=aW.call(ac,X);w(T,O,aJ)}Y=Math.floor(T.rows/2);am=T.height;ad=T.animate;aL=T.display!=="inline";aQ=T.buttons;aF=f(T.context=="body"?window:T.context);L=f(T.context)[0];if(!T.setText){aQ.splice(f.inArray("set",aQ),1)}if(!T.cancelText){aQ.splice(f.inArray("cancel",aQ),1)}if(T.button3){aQ.splice(f.inArray("set",aQ)+1,0,{text:T.button3Text,handler:T.button3})}X.context=aF;X.live=!aL||(f.inArray("set",aQ)==-1);X.buttons.set={text:T.setText,css:"dwb-s",handler:X.select};X.buttons.cancel={text:(X.live)?T.closeText:T.cancelText,css:"dwb-c",handler:X.cancel};X.buttons.clear={text:T.clearText,css:"dwb-cl",handler:function(){X.trigger("onClear",[A]);ax.val("");if(!X.live){X.hide()}}};aD=aQ.length>0;if(E){X.hide(true,false,true)}if(aL){aj();if(aU){if(aO===undefined){aO=ac.readOnly}ac.readOnly=true}X.attachShow(ax)}else{X.show()}if(aU){ax.on("change.dw",function(){if(!ai){X.setValue(ax.val(),false,0.2)}ai=false})}};X.option=function(aV,aW){var aX={};if(typeof aV==="object"){aX=aV}else{aX[aV]=aW}X.init(aX)};X.destroy=function(){X.hide(true,false,true);f.each(aq,function(aW,aV){aV.off(".dw")});f(window).off(".dwa");if(aU){ac.readOnly=aO}delete d[ac.id];W("onDestroy",[])};X.getInst=function(){return X};X.getValidCell=ak;X.trigger=W;d[ac.id]=X;X.values=null;X.val=null;X.temp=null;X.buttons={};X._selectedValues={};X.init(aJ)};function b(y){if(y.type==="touchstart"){g=true}else{if(g){g=false;return false}}return true}function u(){t=true;setTimeout(function(){t=false},300)}function p(A,z,y){return Math.max(z,Math.min(A,y))}function h(y){var z={values:[],keys:[]};f.each(y,function(B,A){z.keys.push(B);z.values.push(A)});return z}var i,n,t,g,v,o=f.mobiscroll,d=o.instances,a=o.util,s=a.prefix,q=a.jsPrefix,l=a.has3d,c=a.getCoord,j=function(){},e=function(y){y.preventDefault()},w=f.extend,r="touchstart mousedown",x="touchmove mousemove",m="touchend mouseup",k={width:70,height:40,rows:3,delay:300,disabled:false,readonly:false,closeOnOverlay:true,showOnFocus:true,showOnTap:true,showLabel:true,wheels:[],theme:"",selectedText:" Selected",closeText:"Close",display:"modal",mode:"scroller",preset:"",lang:"en-US",setText:"Set",cancelText:"Cancel",clearText:"Clear",context:"body",scrollLock:true,tap:true,btnWidth:true,speedUnit:0.0012,timeUnit:0.1,formatResult:function(y){return y.join(" ")},parseValue:function(C,B){var D=C.split(" "),y=[],z=0,A;f.each(B.settings.wheels,function(F,E){f.each(E,function(H,G){G=G.values?G:h(G);A=G.keys||G.values;if(f.inArray(D[z],A)!==-1){y.push(D[z])}else{y.push(A[0])}z++})});return y}};f(window).on("focus",function(){if(i){v=true}});f(document).on("mouseover mouseup mousedown click",function(y){if(t){y.stopPropagation();y.preventDefault();return false}});f.mobiscroll.setDefaults=function(y){w(k,y)}})(jQuery);
